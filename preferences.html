{% extends "base.html" %}

{% block title %}使用者偏好設定 - fastB2B{% endblock %}

{% block content %}
<!-- Toast Notification -->
<div id="toast" class="fixed bottom-5 right-5 bg-green-500 text-white px-4 py-3 rounded shadow-lg hidden z-50 animate__animated animate__fadeInUp">
  <i class="fas fa-check-circle mr-2"></i><span id="toast-message">設定已儲存！</span>
</div>

<script>
  function showToast(message) {
    const toast = document.getElementById("toast");
    const msg = document.getElementById("toast-message");
    msg.textContent = message;
    toast.classList.remove("hidden");
    setTimeout(() => toast.classList.add("hidden"), 3000);
  }

  {% with messages = get_flashed_messages() %}
    {% for msg in messages %}
      window.onload = () => showToast("{{ msg }}");
    {% endfor %}
  {% endwith %}
</script>

<div class="flex justify-center pt-10 pb-20">
  <form method="POST" class="w-full max-w-4xl space-y-10 text-xl">

    <!-- 外框 A -->
    <div class="border-4 border-gray-300 rounded-xl bg-white shadow-lg p-10 space-y-10 animate__animated animate__fadeInUp">
      <!-- 公司資訊 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 公司資訊</h3>
        <div class="space-y-6">
          <div>
            <label class="block font-semibold mb-2">公司名稱：</label>
            <input type="text" name="company_name" value="V資訊股份有限公司" class="w-full border border-gray-400 rounded px-4 py-3 text-lg" />
          </div>
          <div>
            <label class="block font-semibold mb-2">統一編號：</label>
            <input type="text" name="tax_id" value="12345678" class="w-full border border-gray-400 rounded px-4 py-3 text-lg" />
          </div>
          <div>
            <label class="block font-semibold mb-2">聯絡電話：</label>
            <input type="text" name="phone" value="02-12345678" class="w-full border border-gray-400 rounded px-4 py-3 text-lg" />
          </div>
        </div>
      </div>

      <!-- 使用者資訊 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 使用者資訊</h3>
        <div class="space-y-6">
          <div>
            <label class="block font-semibold mb-2">使用者名稱：</label>
            <input type="text" name="username" value="liu_ray_001" class="w-full border border-gray-400 rounded px-4 py-3 text-lg" />
          </div>
          <div>
            <label class="block font-semibold mb-2">Email：</label>
            <input type="email" name="email" value="liu.ray@example.com" class="w-full border border-gray-400 rounded px-4 py-3 text-lg" />
          </div>
        </div>
      </div>
    </div>

    <!-- 外框 B -->
    <div class="border-4 border-gray-300 rounded-xl bg-white shadow-lg p-10 space-y-10 animate__animated animate__fadeInUp animate__delay-1s">
      <!-- 辨識偏好 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 辨識偏好</h3>
        <div class="space-y-6">
          <div>
            <label class="block font-semibold mb-2">發票影像保留天數：</label>
            <select name="retention_days" class="w-full border border-gray-400 rounded px-4 py-3 text-lg">
              <option value="7">7</option>
              <option value="15">15</option>
              <option value="30" selected>30</option>
              <option value="60">60</option>
              <option value="90">90</option>
            </select>
          </div>
          <label class="flex items-center gap-3">
            <input type="checkbox" name="auto_title" checked class="scale-125" />
            <span>自動套用公司抬頭</span>
          </label>
        </div>
      </div>

      <!-- 預設語系 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 預設語系</h3>
        <div class="space-y-6">
          <div>
            <label class="block font-semibold mb-2">語言選擇：</label>
            <select name="language" class="w-full border border-gray-400 rounded px-4 py-3 text-lg">
              <option value="zh-TW">繁體中文</option>
              <option value="zh-CN">简体中文</option>
              <option value="en">English</option>
            </select>
          </div>
          <label class="flex items-center gap-3">
            <input type="checkbox" name="dark_mode" checked class="scale-125" />
            <span>啟用深色模式</span>
          </label>
        </div>
      </div>

      <!-- 自動郵件 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 自動送出郵件</h3>
        <label class="flex items-center gap-3">
          <input type="checkbox" name="auto_email" checked class="scale-125" />
          <span>每月1日自動寄送</span>
        </label>
      </div>

      <!-- 通知設定 -->
      <div>
        <h3 class="text-2xl font-bold text-blue-700 mb-6">🔹 通知設定</h3>
        <div class="space-y-4">
          <label class="flex items-center gap-3">
            <input type="checkbox" name="notify_complete" checked class="scale-125" />
            <span>發票辨識完成通知</span>
          </label>
          <label class="flex items-center gap-3">
            <input type="checkbox" name="notify_error" checked class="scale-125" />
            <span>發票異常提醒</span>
          </label>
        </div>
      </div>

      <!-- 按鈕 -->
      <div class="flex justify-center gap-6 pt-4">
        <button type="button" onclick="location.href='{{ url_for('search') }}'" class="bg-gray-300 hover:bg-gray-400 text-black px-6 py-3 rounded text-lg">
          取消
        </button>
        <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded text-lg font-semibold">
          儲存
        </button>
      </div>
    </div>
  </form>
</div>
{% endblock %}
